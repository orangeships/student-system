# å­¦ç”Ÿè´¢åŠ¡æ”¶æ”¯ç®¡ç†ç³»ç»Ÿ API æ¥å£æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

**é¡¹ç›®åç§°**ï¼šå­¦ç”Ÿè´¢åŠ¡æ”¶æ”¯ç®¡ç†ç³»ç»Ÿ  
**æ¶æ„æ¨¡å¼**ï¼šå‰åç«¯åˆ†ç¦» + RESTful API  
**è®¤è¯æ–¹å¼**ï¼šJWT Token  
**åŸºç¡€URL**ï¼š`http://localhost:8000/api`  
**ç‰ˆæœ¬**ï¼šv1.0

---

## ğŸ” è®¤è¯ç›¸å…³æ¥å£

### 1. ç”¨æˆ·æ³¨å†Œ
**ç«¯ç‚¹**ï¼š`POST /auth/register`  
**æè¿°**ï¼šæ–°ç”¨æˆ·æ³¨å†Œ

**è¯·æ±‚ä½“**ï¼š
```json
{
  "username": "string, å¿…å¡«, å”¯ä¸€, æœ€å°3å­—ç¬¦",
  "email": "string, å¿…å¡«, æœ‰æ•ˆçš„é‚®ç®±æ ¼å¼",
  "password": "string, å¿…å¡«, æœ€å°6å­—ç¬¦",
  "confirm_password": "string, å¿…å¡«, ä¸passwordä¸€è‡´"
}
```

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 201,
  "message": "æ³¨å†ŒæˆåŠŸ",
  "data": {
    "user": {
      "id": 1,
      "username": "student01",
      "email": "student@example.com"
    },
    "token": "jwt_token_here"
  }
}
```

### 2. ç”¨æˆ·ç™»å½•
**ç«¯ç‚¹**ï¼š`POST /auth/login`  
**æè¿°**ï¼šç”¨æˆ·ç™»å½•è·å–token

**è¯·æ±‚ä½“**ï¼š
```json
{
  "username": "string, å¿…å¡«",
  "password": "string, å¿…å¡«"
}
```

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "user": {
      "id": 1,
      "username": "student01",
      "email": "student@example.com",
      "monthly_budget": 2000.00
    },
    "token": "jwt_token_here"
  }
}
```

### 3. è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
**ç«¯ç‚¹**ï¼š`GET /auth/user`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šè·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "data": {
    "id": 1,
    "username": "student01",
    "email": "student@example.com",
    "monthly_budget": 2000.00,
    "created_at": "2024-01-01T00:00:00Z"
  }
}
```

---

## ğŸ‘¤ ç”¨æˆ·ç®¡ç†æ¥å£

### 4. æ›´æ–°ç”¨æˆ·ä¿¡æ¯
**ç«¯ç‚¹**ï¼š`PUT /users/profile`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šæ›´æ–°ç”¨æˆ·ä¸ªäººä¿¡æ¯

**è¯·æ±‚ä½“**ï¼š
```json
{
  "email": "string, å¯é€‰, æœ‰æ•ˆçš„é‚®ç®±æ ¼å¼",
  "monthly_budget": "number, å¯é€‰, æœˆåº¦é¢„ç®—é‡‘é¢"
}
```

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "message": "æ›´æ–°æˆåŠŸ",
  "data": {
    "id": 1,
    "username": "student01",
    "email": "new_email@example.com",
    "monthly_budget": 2500.00
  }
}
```

---

## ğŸ’° äº¤æ˜“è®°å½•æ¥å£

### 5. è·å–äº¤æ˜“è®°å½•åˆ—è¡¨
**ç«¯ç‚¹**ï¼š`GET /transactions`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šè·å–ç”¨æˆ·çš„äº¤æ˜“è®°å½•ï¼Œæ”¯æŒåˆ†é¡µå’Œç­›é€‰

**æŸ¥è¯¢å‚æ•°**ï¼š
- `page`ï¼šé¡µç ï¼Œé»˜è®¤1
- `page_size`ï¼šæ¯é¡µæ•°é‡ï¼Œé»˜è®¤20
- `type`ï¼šç±»å‹è¿‡æ»¤ï¼Œ`income`æˆ–`expense`
- `category`ï¼šåˆ†ç±»è¿‡æ»¤
- `start_date`ï¼šå¼€å§‹æ—¥æœŸï¼Œ`YYYY-MM-DD`
- `end_date`ï¼šç»“æŸæ—¥æœŸï¼Œ`YYYY-MM-DD`

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "data": {
    "transactions": [
      {
        "id": 1,
        "amount": 50.50,
        "type": "expense",
        "category": "é¤é¥®",
        "category_color": "#FF6B6B",
        "date": "2024-01-15",
        "notes": "åˆé¤",
        "created_at": "2024-01-15T12:00:00Z"
      }
    ],
    "pagination": {
      "total": 150,
      "page": 1,
      "page_size": 20,
      "total_pages": 8
    }
  }
}
```

### 6. åˆ›å»ºäº¤æ˜“è®°å½•
**ç«¯ç‚¹**ï¼š`POST /transactions`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šåˆ›å»ºæ–°çš„äº¤æ˜“è®°å½•

**è¯·æ±‚ä½“**ï¼š
```json
{
  "amount": "number, å¿…å¡«, æ­£æ•°",
  "type": "string, å¿…å¡«, 'income' æˆ– 'expense'",
  "category": "string, å¿…å¡«, åˆ†ç±»åç§°",
  "date": "string, å¿…å¡«, YYYY-MM-DDæ ¼å¼",
  "notes": "string, å¯é€‰, å¤‡æ³¨ä¿¡æ¯"
}
```

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 201,
  "message": "äº¤æ˜“è®°å½•åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": 1,
    "amount": 50.50,
    "type": "expense",
    "category": "é¤é¥®",
    "date": "2024-01-15",
    "notes": "åˆé¤",
    "created_at": "2024-01-15T12:00:00Z"
  }
}
```

### 7. è·å–å•æ¡äº¤æ˜“è®°å½•
**ç«¯ç‚¹**ï¼š`GET /transactions/{id}`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šè·å–æŒ‡å®šIDçš„äº¤æ˜“è®°å½•è¯¦æƒ…

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "data": {
    "id": 1,
    "amount": 50.50,
    "type": "expense",
    "category": "é¤é¥®",
    "date": "2024-01-15",
    "notes": "åˆé¤",
    "created_at": "2024-01-15T12:00:00Z",
    "updated_at": "2024-01-15T12:00:00Z"
  }
}
```

### 8. æ›´æ–°äº¤æ˜“è®°å½•
**ç«¯ç‚¹**ï¼š`PUT /transactions/{id}`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šæ›´æ–°æŒ‡å®šIDçš„äº¤æ˜“è®°å½•

**è¯·æ±‚ä½“**ï¼šåŒåˆ›å»ºäº¤æ˜“è®°å½•

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "message": "äº¤æ˜“è®°å½•æ›´æ–°æˆåŠŸ",
  "data": {
    "id": 1,
    "amount": 55.00,
    "type": "expense",
    "category": "é¤é¥®",
    "date": "2024-01-15",
    "notes": "åˆé¤å’Œé¥®æ–™",
    "updated_at": "2024-01-15T14:00:00Z"
  }
}
```

### 9. åˆ é™¤äº¤æ˜“è®°å½•
**ç«¯ç‚¹**ï¼š`DELETE /transactions/{id}`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šåˆ é™¤æŒ‡å®šIDçš„äº¤æ˜“è®°å½•

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "message": "äº¤æ˜“è®°å½•åˆ é™¤æˆåŠŸ"
}
```

---

## ğŸ“Š ç»Ÿè®¡åˆ†ææ¥å£

### 10. æœˆåº¦ç»Ÿè®¡æ¦‚è§ˆ
**ç«¯ç‚¹**ï¼š`GET /statistics/monthly`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šè·å–å½“å‰æœˆåº¦çš„æ”¶æ”¯ç»Ÿè®¡æ¦‚è§ˆ

**æŸ¥è¯¢å‚æ•°**ï¼š
- `year`ï¼šå¹´ä»½ï¼Œé»˜è®¤å½“å‰å¹´
- `month`ï¼šæœˆä»½ï¼Œé»˜è®¤å½“å‰æœˆ

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "data": {
    "year": 2024,
    "month": 1,
    "total_income": 3000.00,
    "total_expense": 1850.50,
    "balance": 1149.50,
    "budget_progress": {
      "budget_amount": 2000.00,
      "current_spent": 1850.50,
      "progress_percentage": 92.5,
      "remaining": 149.50,
      "is_over_budget": false
    },
    "daily_average_expense": 61.68
  }
}
```

### 11. åˆ†ç±»ç»Ÿè®¡
**ç«¯ç‚¹**ï¼š`GET /statistics/categories`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šè·å–åˆ†ç±»ç»Ÿè®¡ä¿¡æ¯ï¼Œç”¨äºé¥¼å›¾å±•ç¤º

**æŸ¥è¯¢å‚æ•°**ï¼š
- `year`ï¼šå¹´ä»½
- `month`ï¼šæœˆä»½
- `type`ï¼šç±»å‹ï¼Œ`income`æˆ–`expense`ï¼Œé»˜è®¤`expense`

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "data": {
    "period": {
      "year": 2024,
      "month": 1
    },
    "type": "expense",
    "categories": [
      {
        "name": "é¤é¥®",
        "amount": 650.50,
        "percentage": 35.2,
        "color": "#FF6B6B",
        "count": 28
      },
      {
        "name": "è´­ç‰©",
        "amount": 420.00,
        "percentage": 22.7,
        "color": "#4ECDC4",
        "count": 15
      }
    ],
    "total_amount": 1850.50
  }
}
```

### 12. æ”¶æ”¯è¶‹åŠ¿åˆ†æ
**ç«¯ç‚¹**ï¼š`GET /statistics/trend`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šè·å–æ”¶æ”¯è¶‹åŠ¿æ•°æ®ï¼Œç”¨äºæŠ˜çº¿å›¾å±•ç¤º

**æŸ¥è¯¢å‚æ•°**ï¼š
- `range`ï¼šæ—¶é—´èŒƒå›´ï¼Œ`1m`(1ä¸ªæœˆ)ã€`3m`(3ä¸ªæœˆ)ã€`6m`(6ä¸ªæœˆ)ã€`1y`(1å¹´)ï¼Œé»˜è®¤`3m`

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "data": {
    "range": "3m",
    "periods": [
      {
        "year": 2024,
        "month": 1,
        "income": 3000.00,
        "expense": 1850.50,
        "balance": 1149.50
      },
      {
        "year": 2023,
        "month": 12,
        "income": 2800.00,
        "expense": 1650.00,
        "balance": 1150.00
      },
      {
        "year": 2023,
        "month": 11,
        "income": 2500.00,
        "expense": 1800.00,
        "balance": 700.00
      }
    ]
  }
}
```

---

## ğŸ¯ æ•°æ®è§„åˆ’æ¥å£

### 13. è´¢åŠ¡é¢„æµ‹
**ç«¯ç‚¹**ï¼š`GET /planning/prediction`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šè·å–æœªæ¥å‡ ä¸ªæœˆçš„è´¢åŠ¡é¢„æµ‹

**æŸ¥è¯¢å‚æ•°**ï¼š
- `months`ï¼šé¢„æµ‹æœˆæ•°ï¼Œé»˜è®¤3

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "data": {
    "predictions": [
      {
        "year": 2024,
        "month": 2,
        "predicted_income": 2900.00,
        "predicted_expense": 1750.00,
        "predicted_balance": 1150.00,
        "confidence": 0.85
      },
      {
        "year": 2024,
        "month": 3,
        "predicted_income": 3000.00,
        "predicted_expense": 1900.00,
        "predicted_balance": 1100.00,
        "confidence": 0.78
      }
    ],
    "based_on_months": 6
  }
}
```

### 14. è®¾ç½®åˆ†ç±»é¢„ç®—
**ç«¯ç‚¹**ï¼š`POST /planning/budgets`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šè®¾ç½®æˆ–æ›´æ–°åˆ†ç±»é¢„ç®—

**è¯·æ±‚ä½“**ï¼š
```json
{
  "category": "string, å¿…å¡«, åˆ†ç±»åç§°",
  "amount": "number, å¿…å¡«, é¢„ç®—é‡‘é¢",
  "month": "string, å¯é€‰, YYYY-MMæ ¼å¼ï¼Œé»˜è®¤å½“å‰æœˆ"
}
```

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 201,
  "message": "é¢„ç®—è®¾ç½®æˆåŠŸ",
  "data": {
    "id": 1,
    "category": "é¤é¥®",
    "amount": 600.00,
    "month": "2024-01",
    "current_spent": 450.50,
    "remaining": 149.50
  }
}
```

### 15. è·å–é¢„ç®—å»ºè®®
**ç«¯ç‚¹**ï¼š`GET /planning/recommendations`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šè·å–ä¸ªæ€§åŒ–çš„é¢„ç®—å’Œå‚¨è“„å»ºè®®

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "data": {
    "budget_recommendations": [
      {
        "category": "é¤é¥®",
        "current_avg": 650.50,
        "recommended": 550.00,
        "reason": "ç›¸æ¯”ä¸Šæœˆå¢é•¿20%ï¼Œå»ºè®®é€‚å½“æ§åˆ¶"
      }
    ],
    "savings_advice": [
      "æœ¬æœˆå¯å‚¨è“„é‡‘é¢é¢„è®¡ä¸º1149.50å…ƒ",
      "å»ºè®®å°†30%çš„ç»“ä½™ç”¨äºç´§æ€¥å¤‡ç”¨é‡‘"
    ],
    "financial_health": {
      "score": 75,
      "level": "è‰¯å¥½",
      "improvement_suggestions": [
        "é¤é¥®æ”¯å‡ºå æ¯”åé«˜",
        "å‚¨è“„ç‡è¾¾åˆ°38%ï¼Œè¡¨ç°ä¼˜ç§€"
      ]
    }
  }
}
```

---

## ğŸš¨ é¢„è­¦ç³»ç»Ÿæ¥å£

### 16. è·å–é¢„è­¦åˆ—è¡¨
**ç«¯ç‚¹**ï¼š`GET /alerts`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šè·å–å½“å‰ç”¨æˆ·çš„è´¢åŠ¡é¢„è­¦

**æŸ¥è¯¢å‚æ•°**ï¼š
- `is_read`ï¼šæ˜¯å¦å·²è¯»ï¼Œ`true`æˆ–`false`

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "data": {
    "alerts": [
      {
        "id": 1,
        "type": "budget",
        "title": "é¢„ç®—é¢„è­¦",
        "message": "é¤é¥®é¢„ç®—å·²ä½¿ç”¨75%",
        "level": "warning",
        "related_data": {
          "category": "é¤é¥®",
          "budget_amount": 600.00,
          "current_spent": 450.50,
          "percentage": 75.0
        },
        "is_read": false,
        "created_at": "2024-01-20T10:00:00Z"
      }
    ]
  }
}
```

### 17. æ ‡è®°é¢„è­¦å·²è¯»
**ç«¯ç‚¹**ï¼š`PUT /alerts/{id}/read`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šå°†é¢„è­¦æ ‡è®°ä¸ºå·²è¯»

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "message": "é¢„è­¦å·²æ ‡è®°ä¸ºå·²è¯»"
}
```

---

## ğŸ“ æ•°æ®å¯¼å‡ºæ¥å£

### 18. å¯¼å‡ºäº¤æ˜“è®°å½•
**ç«¯ç‚¹**ï¼š`POST /export/transactions`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šå¯¼å‡ºäº¤æ˜“è®°å½•ä¸ºCSVæˆ–Excelæ–‡ä»¶

**è¯·æ±‚ä½“**ï¼š
```json
{
  "format": "string, å¿…å¡«, 'csv' æˆ– 'excel'",
  "start_date": "string, å¯é€‰, YYYY-MM-DD",
  "end_date": "string, å¯é€‰, YYYY-MM-DD",
  "include_categories": "array, å¯é€‰, åŒ…å«çš„åˆ†ç±»"
}
```

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "data": {
    "export_id": "export_12345",
    "download_url": "/api/export/download/export_12345",
    "estimated_time": "10ç§’"
  }
}
```

### 19. ä¸‹è½½å¯¼å‡ºæ–‡ä»¶
**ç«¯ç‚¹**ï¼š`GET /export/download/{export_id}`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šä¸‹è½½å¯¼å‡ºçš„æ–‡ä»¶

**å“åº”**ï¼šæ–‡ä»¶æµä¸‹è½½

---

## ğŸ·ï¸ ç³»ç»Ÿé…ç½®æ¥å£

### 20. è·å–åˆ†ç±»åˆ—è¡¨
**ç«¯ç‚¹**ï¼š`GET /categories`  
**è®¤è¯**ï¼šéœ€è¦Token  
**æè¿°**ï¼šè·å–ç³»ç»Ÿæ”¯æŒçš„äº¤æ˜“åˆ†ç±»

**æŸ¥è¯¢å‚æ•°**ï¼š
- `type`ï¼šç±»å‹ï¼Œ`income`æˆ–`expense`

**å“åº”æˆåŠŸ**ï¼š
```json
{
  "code": 200,
  "data": {
    "categories": [
      {
        "name": "é¤é¥®",
        "type": "expense",
        "color": "#FF6B6B",
        "icon": "restaurant",
        "description": "é£Ÿç‰©å’Œé¥®æ–™ç›¸å…³æ”¯å‡º"
      },
      {
        "name": "å¥–å­¦é‡‘",
        "type": "income", 
        "color": "#4ECDC4",
        "icon": "school",
        "description": "å­¦æ ¡é¢å‘çš„å¥–å­¦é‡‘"
      }
    ]
  }
}
```

---

## âš ï¸ é”™è¯¯å“åº”æ ¼å¼

æ‰€æœ‰æ¥å£çš„é”™è¯¯å“åº”éƒ½éµå¾ªç»Ÿä¸€æ ¼å¼ï¼š

```json
{
  "code": 400,
  "message": "é”™è¯¯æè¿°ä¿¡æ¯",
  "errors": {
    "field_name": ["å…·ä½“çš„é”™è¯¯ä¿¡æ¯"]
  }
}
```

### å¸¸è§é”™è¯¯ç ï¼š
- `400`ï¼šè¯·æ±‚å‚æ•°é”™è¯¯
- `401`ï¼šæœªè®¤è¯
- `403`ï¼šæƒé™ä¸è¶³
- `404`ï¼šèµ„æºä¸å­˜åœ¨
- `500`ï¼šæœåŠ¡å™¨å†…éƒ¨é”™è¯¯

---

## ğŸ”„ æ¥å£å˜æ›´è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´è¯´æ˜ |
|------|------|----------|
| v1.0 | 2025-01-20 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŒ…å«æ‰€æœ‰æ ¸å¿ƒæ¥å£ |

---

è¿™ä»½APIæ–‡æ¡£ä¸ºå‰åç«¯å¼€å‘æä¾›äº†æ¸…æ™°çš„å¥‘çº¦ã€‚å‰ç«¯å¯ä»¥æ ¹æ®è¿™ä»½æ–‡æ¡£å¼€å§‹Mockæ•°æ®å¼€å‘å’Œç•Œé¢å®ç°ï¼Œåç«¯åˆ™æŒ‰ç…§è¿™ä¸ªè§„èŒƒè¿›è¡Œæ¥å£å¼€å‘ã€‚åŒæ–¹å¯ä»¥å¹¶è¡Œå·¥ä½œï¼Œå®šæœŸé›†æˆæµ‹è¯•ã€‚
